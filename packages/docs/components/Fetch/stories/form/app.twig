{% set initial_value %}
{% verbatim %}
<div class="p-6 rounded bg-green-200 dark:bg-green-200/30">
  The date is <strong>{{ 'now'|date('F j, Y H:i:s') }}</strong>.
</div>
{% endverbatim %}
{% endset %}

<div class="grid gap-8 max-w-2xl">

  <form data-component="Fetch Action"
    data-on:mounted="setTimeout(() => target.$el.requestSubmit())"
    data-on:fetch-before="Transition(#loader) -> target.enter()"
    data-on:fetch-after="Transition(#loader) -> target.leave()"
    class="grid gap-4"
    action="/api"
    method="POST"
    if="form">
    <input type="hidden" name="wait" value="1">
    <textarea
      class="w-full py-4 px-6 border border-current/20 rounded resize-none font-mono text-sm"
      rows="10"
      data-component="DataModel Action"
      data-on:input="Fetch(#form) -> target.$el.requestSubmit()"
      data-option-group="content">{{ initial_value }}</textarea>
    <textarea
      class="hidden"
      data-component="DataComputed"
      data-option-group="content"
      type="text"
      data-option-compute="`<div id='target'>${value}</div>`"
      name="content"
      readonly><div id='target'>{{ initial_value }}</div></textarea>
    <div class="flex items-center gap-8">
      {{ include('@ui/Button/StyledButton.twig', { label: 'Submit', icon: 'mdi:send', attr: { type: 'submit' } }) }}
      <div
        data-component="Transition"
        data-option-enter-from="opacity-0 scale-0"
        data-option-enter-active="transition"
        data-option-leave-to="opacity-0 scale-0"
        data-option-leave-active="transition"
        data-option-leave-keep
        class="opacity-0 scale-0"
        id="loader">
        <div class="w-4 h-4 border-2 rounded-full border-current border-t-transparent animate-loader"></div>
      </div>
    </div>
  </form>

  <div id="target"></div>
</div>
